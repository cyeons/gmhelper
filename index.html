<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>공문서 작성 서비스</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    label { display: block; margin: 10px 0 5px; }
    input, textarea { width: 100%; max-width: 500px; padding: 5px; }
    button { margin-top: 10px; padding: 10px 20px; }
    #output { margin-top: 20px; white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; }
  </style>
</head>
<body>
  <h1>공문서 작성 서비스</h1>
  
  <label for="related">1. 관련 (부서명-문서번호(날짜, "제목") 형식)</label>
  <textarea id="related" rows="3" placeholder="예: 기획부-123(2024.01.01., “2024년 행사 계획 안내”)"></textarea>

  <label for="content">2. 본문 (목적 및 세부 내용)</label>
  <textarea id="content" rows="5" placeholder="예: 2024년 학교 행사 관련 안내. 가. 목적: 행사 준비, 나. 대상: 전교생, 다. 기간: 2024.01.01.~2024.12.31., 라. 세부사항: 일시 2024.05.01. 10:00 장소 학교 강당"></textarea>

  <label for="admin">3. 행정사항 (선택, 위촉장 대체 및 문의 포함 가능)</label>
  <textarea id="admin" rows="3" placeholder="예: 본 공문으로 위촉장 대신, 문의: 02-123-4567"></textarea>

  <label for="attachment">붙임 (첨부 자료)</label>
  <textarea id="attachment" rows="3" placeholder="예: 2024년 행사 계획서 1부"></textarea>

  <button onclick="generateDoc()">공문서 생성</button>
  <pre id="output">여기에 생성된 공문서가 표시됩니다.</pre>

  <script>
    async function generateDoc() {
      const related = document.getElementById('related').value;
      const content = document.getElementById('content').value;
      const admin = document.getElementById('admin').value;
      const attachment = document.getElementById('attachment').value;

      if (!related || !content || !attachment) {
        document.getElementById('output').innerText = '필수 항목(관련, 본문, 붙임)을 모두 입력해주세요.';
        return;
      }

      try {
        const response = await fetch('/.netlify/functions/generateDoc', {
          method: 'POST',
          body: JSON.stringify({ related, content, admin, attachment }),
        });
        const data = await response.json();
        document.getElementById('output').innerText = data.generatedDoc || data.error;
      } catch (error) {
        document.getElementById('output').innerText = '오류 발생: ' + error.message;
      }
    }
  </script>
</body>
</html>